{% extends 'base.html' %}

{% block title %}Daily Sales Report{% endblock %}

{% block content %}
<div class="container mt-4" id="printable-area">
    <h2 class="text-center">New Pavan Restaurant & Bar</h2>
    <p class="text-center">
        Date: {{ today.strftime('%Y-%m-%d') }}
    </p>

    {% for brand_type, brands in report_data.items() %}
    <h3 class="mt-4">{{ brand_type }}</h3>
    {% set sizes = brands.values() | list %}
    {% set sizes_list = sizes[0].sizes.keys() if sizes else [] %}
    <table class="table table-bordered table-sm table-striped">
        <thead>
            <tr>
                <th rowspan="2" style="vertical-align: middle;">Brand Name</th>
                {% for col in ['OB', 'CB', 'New Stock', 'Sale', 'Amount'] %}
                <th class="text-center" colspan="{{ sizes_list | length }}">{{ col }}</th>
                {% endfor %}
            </tr>
            <tr>
                {% for _ in range(5) %}
                {% for size in sizes_list %}
                <th class="text-center">{{ size }}</th>
                {% endfor %}
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for brand_name, brand_data in brands.items() %}
            <tr>
                <td>{{ brand_name }}</td>
                {% for col in ['ob', 'cb', 'new_stock', 'sale', 'amount'] %}
                {% for size in sizes_list %}
                <td class="text-center">{{ brand_data.sizes[size][col] if size in brand_data.sizes else '' }}</td>
                {% endfor %}
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endfor %}

    <h3 class="mt-4">Grand Total</h3>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Brand Type</th>
                <th>Total Sale (₹)</th>
            </tr>
        </thead>
        <tbody>
            {% for brand_type, total_sale in grand_total_sales_by_type.items() %}
            <tr>
                <td>{{ brand_type }}</td>
                <td>₹{{ total_sale }}</td>
            </tr>
            {% endfor %}
            <tr>
                <th>Grand Total</th>
                <th>₹{{ grand_total_sale }}</th>
            </tr>
        </tbody>
    </table>
</div>
<div class="d-flex justify-content-end mb-3">
    <!-- <a href="/export/excel" class="btn btn-success me-2">Export to Excel</a>
    <a href="/export/pdf" class="btn btn-danger me-2">Export to PDF</a> -->
    <button class="btn btn-primary" onclick="printReport()">Print</button>
</div>
<script>
function printReport() {
    window.print();
}
</script>
{% endblock %}
